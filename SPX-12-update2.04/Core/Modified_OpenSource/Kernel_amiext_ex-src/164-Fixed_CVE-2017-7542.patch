diff -Naur linux_org/net/ipv6/output_core.c linux/net/ipv6/output_core.c
--- linux_org/net/ipv6/output_core.c	2019-03-27 14:09:52.679895759 +0800
+++ linux/net/ipv6/output_core.c	2019-03-27 15:18:00.473703663 +0800
@@ -10,7 +10,7 @@
 
 int ip6_find_1stfragopt(struct sk_buff *skb, u8 **nexthdr)
 {
-	u16 offset = sizeof(struct ipv6hdr);
+	unsigned int offset = sizeof(struct ipv6hdr);
 	unsigned int packet_len = skb_tail_pointer(skb) -
 		skb_network_header(skb);
 	int found_rhdr = 0;
@@ -18,7 +18,8 @@
 
 	while (offset <= packet_len) {
 		struct ipv6_opt_hdr *exthdr;
-
+		unsigned int len;
+		
 		switch (**nexthdr) {
 
 		case NEXTHDR_HOP:
@@ -42,7 +43,10 @@
 			return -EINVAL;
 		exthdr = (struct ipv6_opt_hdr *)(skb_network_header(skb) +
 						 offset);
-		offset += ipv6_optlen(exthdr);
+		len = ipv6_optlen(exthdr);
+		if (len + offset >= IPV6_MAXPLEN)
+			return -EINVAL;
+		offset += len;		
 		*nexthdr = &exthdr->nexthdr;						 
 	}
 
