--- a/fs/namespace.c	2019-09-03 14:02:16.639839099 +0800
+++ b/fs/namespace.c	2019-09-03 14:09:29.968103637 +0800
@@ -2837,6 +2837,9 @@
 	/* make sure we can reach put_old from new_root */
 	if (!is_path_reachable(old_mnt, old.dentry, &new))
 		goto out4;
+	/* make certain new is below the root */
+	if (!is_path_reachable(new_mnt, new.dentry, &root))
+		goto out4;
 	root_mp->m_count++; /* pin it so it won't go away */
 	lock_mount_hash();
 	detach_mnt(new_mnt, &parent_path);
