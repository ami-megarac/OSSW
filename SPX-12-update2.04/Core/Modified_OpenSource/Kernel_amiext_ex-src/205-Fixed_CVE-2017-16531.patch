diff -Naur linux_org/drivers/usb/core/config.c linux/drivers/usb/core/config.c
--- linux_org/drivers/usb/core/config.c	2019-04-11 14:57:50.377454800 +0800
+++ linux/drivers/usb/core/config.c	2019-04-11 14:59:24.827055213 +0800
@@ -512,15 +512,22 @@
 
 		} else if (header->bDescriptorType ==
 				USB_DT_INTERFACE_ASSOCIATION) {
+			struct usb_interface_assoc_descriptor *d;
+
+			d = (struct usb_interface_assoc_descriptor *)header;
+			if (d->bLength < USB_DT_INTERFACE_ASSOCIATION_SIZE) {
+				dev_warn(ddev,
+					 "config %d has an invalid interface association descriptor of length %d, skipping\n",
+					 cfgno, d->bLength);
+				continue;
+			}					
 			if (iad_num == USB_MAXIADS) {
 				dev_warn(ddev, "found more Interface "
 					       "Association Descriptors "
 					       "than allocated for in "
 					       "configuration %d\n", cfgno);
 			} else {
-				config->intf_assoc[iad_num] =
-					(struct usb_interface_assoc_descriptor
-					*)header;
+				config->intf_assoc[iad_num] = d;
 				iad_num++;
 			}
 
diff -Naur linux_org/include/uapi/linux/usb/ch9.h linux/include/uapi/linux/usb/ch9.h
--- linux_org/include/uapi/linux/usb/ch9.h	2019-04-11 14:58:33.630948698 +0800
+++ linux/include/uapi/linux/usb/ch9.h	2019-04-11 14:59:58.303103702 +0800
@@ -705,6 +705,7 @@
 	__u8  iFunction;
 } __attribute__ ((packed));
 
+#define USB_DT_INTERFACE_ASSOCIATION_SIZE	8
 
 /*-------------------------------------------------------------------------*/
 
