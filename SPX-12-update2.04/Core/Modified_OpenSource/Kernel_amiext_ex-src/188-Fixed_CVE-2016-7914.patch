diff -Naur linux_org/lib/assoc_array.c linux/lib/assoc_array.c
--- linux_org/lib/assoc_array.c	2019-04-09 14:07:46.702307803 +0800
+++ linux/lib/assoc_array.c	2019-04-09 14:08:11.669866986 +0800
@@ -523,7 +523,9 @@
 			free_slot = i;
 			continue;
 		}
-		if (ops->compare_object(assoc_array_ptr_to_leaf(ptr), index_key)) {
+		if (assoc_array_ptr_is_leaf(ptr) &&
+		    ops->compare_object(assoc_array_ptr_to_leaf(ptr),
+					index_key)) {
 			pr_devel("replace in slot %d\n", i);
 			edit->leaf_p = &node->slots[i];
 			edit->dead_leaf = node->slots[i];
