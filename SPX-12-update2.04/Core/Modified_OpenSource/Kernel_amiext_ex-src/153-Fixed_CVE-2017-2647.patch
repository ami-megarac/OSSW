diff -Naur linux_org/security/keys/keyring.c linux/security/keys/keyring.c
--- linux_org/security/keys/keyring.c	2019-03-25 13:57:02.499392653 +0800
+++ linux/security/keys/keyring.c	2019-03-25 14:44:14.779874758 +0800
@@ -848,6 +848,9 @@
 			return ERR_PTR(err);
 	}
 
+	if (!ctx->match)
+		return ERR_PTR(-ENOKEY);	
+	
 	rcu_read_lock();
 	ctx->now = current_kernel_time();
 	if (search_nested_keyrings(keyring, ctx))
@@ -878,10 +881,7 @@
 		.flags			= (type->def_lookup_type |
 					   KEYRING_SEARCH_DO_STATE_CHECK),
 	};
-
-	if (!ctx.match)
-		return ERR_PTR(-ENOKEY);
-
+	
 	return keyring_search_aux(keyring, &ctx);
 }
 EXPORT_SYMBOL(keyring_search);
