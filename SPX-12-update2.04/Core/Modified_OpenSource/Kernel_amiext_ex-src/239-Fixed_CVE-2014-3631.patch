--- a/lib/assoc_array.c	2019-08-14 14:34:13.515919630 +0800
+++ b/lib/assoc_array.c	2019-08-14 17:07:55.057111633 +0800
@@ -1725,11 +1725,13 @@
 		shortcut = assoc_array_ptr_to_shortcut(ptr);
 		slot = shortcut->parent_slot;
 		cursor = shortcut->back_pointer;
+		if (!cursor)
+			goto gc_complete;
 	} else {
 		slot = node->parent_slot;
 		cursor = ptr;
 	}
-	BUG_ON(!ptr);
+	BUG_ON(!cursor);
 	node = assoc_array_ptr_to_node(cursor);
 	slot++;
 	goto continue_node;
