diff -Naur linux_org/security/keys/key.c linux/security/keys/key.c
--- linux_org/security/keys/key.c	2019-04-02 13:44:49.067062123 +0800
+++ linux/security/keys/key.c	2019-04-02 13:50:09.535412912 +0800
@@ -577,7 +577,7 @@
 
 	mutex_unlock(&key_construction_mutex);
 
-	if (keyring)
+	if (keyring && link_ret == 0)
 		__key_link_end(keyring, &key->index_key, edit);
 
 	/* wake up anyone waiting for a key to be constructed */
