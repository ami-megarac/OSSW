--- a/net/ieee802154/af_ieee802154.c	2019-11-14 17:57:14.387776492 +0800
+++ b/net/ieee802154/af_ieee802154.c	2019-11-15 14:40:59.850763084 +0800
@@ -253,6 +253,9 @@
 
 	switch (sock->type) {
 	case SOCK_RAW:
+		rc = -EPERM;
+		if (!capable(CAP_NET_RAW))
+			goto out;
 		proto = &ieee802154_raw_prot;
 		ops = &ieee802154_raw_ops;
 		break;
