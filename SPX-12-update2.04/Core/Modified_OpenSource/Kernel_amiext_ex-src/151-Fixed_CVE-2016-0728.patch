--- linux_org/security/keys/process_keys.c	2019-03-25 13:57:08.651082911 +0800
+++ linux/security/keys/process_keys.c	2019-03-25 13:58:46.031703546 +0800
@@ -793,6 +793,7 @@
 		ret = PTR_ERR(keyring);
 		goto error2;
 	} else if (keyring == new->session_keyring) {
+		key_put(keyring);
 		ret = 0;
 		goto error2;
 	}
