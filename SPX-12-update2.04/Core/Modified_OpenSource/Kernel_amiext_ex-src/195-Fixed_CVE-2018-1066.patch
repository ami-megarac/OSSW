diff -Naur linux_org/fs/cifs/smb2pdu.c linux/fs/cifs/smb2pdu.c
--- linux_org/fs/cifs/smb2pdu.c	2019-04-10 15:41:14.138050003 +0800
+++ linux/fs/cifs/smb2pdu.c	2019-04-10 15:48:26.717371589 +0800
@@ -560,7 +560,8 @@
 	 */
 	kfree(ses->auth_key.response);
 	ses->auth_key.response = NULL;
-
+	ses->auth_key.len = 0;
+	
 	/*
 	 * If memory allocation is successful, caller of this function
 	 * frees it.
@@ -722,6 +723,7 @@
 			rc = server->ops->generate_signingkey(ses);
 			kfree(ses->auth_key.response);
 			ses->auth_key.response = NULL;
+			ses->auth_key.len = 0;
 			if (rc) {
 				cifs_dbg(FYI,
 					"SMB3 session key generation failed\n");
@@ -746,6 +748,7 @@
 	if (!server->sign) {
 		kfree(ses->auth_key.response);
 		ses->auth_key.response = NULL;
+		ses->auth_key.len = 0;
 	}
 	kfree(ses->ntlmssp);
 
