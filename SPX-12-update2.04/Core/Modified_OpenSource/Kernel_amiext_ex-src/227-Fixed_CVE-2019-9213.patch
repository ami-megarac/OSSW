--- a/mm/mmap.c	2019-08-06 16:31:00.450712348 +0800
+++ b/mm/mmap.c	2019-08-07 15:59:50.019433758 +0800
@@ -2203,7 +2203,7 @@
 {
 	struct vm_area_struct *prev;
 	unsigned long gap_addr;	
-	int error;
+	int error = 0;
 
 	/* Enforce stack_guard_gap */
 	gap_addr = address - stack_guard_gap;
@@ -2224,9 +2224,8 @@
 		return -ENOMEM;
 
 	address &= PAGE_MASK;
-	error = security_mmap_addr(address);
-	if (error)
-		return error;
+	if (address < mmap_min_addr)
+		return -EPERM;
 
 	vma_lock_anon_vma(vma);
 
