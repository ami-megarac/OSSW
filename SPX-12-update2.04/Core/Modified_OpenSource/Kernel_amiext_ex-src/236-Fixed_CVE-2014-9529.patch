--- a/security/keys/gc.c	2019-08-14 14:34:16.219918465 +0800
+++ b/security/keys/gc.c	2019-08-14 15:53:19.975975992 +0800
@@ -157,12 +157,12 @@
 		if (test_bit(KEY_FLAG_INSTANTIATED, &key->flags))
 			atomic_dec(&key->user->nikeys);
 
-		key_user_put(key->user);
-
 		/* now throw away the key memory */
 		if (key->type->destroy)
 			key->type->destroy(key);
 
+		key_user_put(key->user);
+
 		kfree(key->description);
 
 #ifdef KEY_DEBUGGING
