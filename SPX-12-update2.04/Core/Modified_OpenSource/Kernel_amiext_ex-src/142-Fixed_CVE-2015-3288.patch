diff -Naur linux_org/mm/memory.c linux/mm/memory.c
--- linux_org/mm/memory.c	2019-03-21 15:41:23.300420049 +0800
+++ linux/mm/memory.c	2019-03-21 15:58:38.225949803 +0800
@@ -3243,6 +3243,10 @@
 
 	pte_unmap(page_table);
 
+	/* File mapping without ->vm_ops ? */
+	if (vma->vm_flags & VM_SHARED)
+		return VM_FAULT_SIGBUS;	
+	
 	/* Check if we need to add a guard page to the stack */
 	if (check_stack_guard_page(vma, address) < 0)
 		return VM_FAULT_SIGBUS;
@@ -3511,6 +3515,9 @@
 			- vma->vm_start) >> PAGE_SHIFT) + vma->vm_pgoff;
 
 	pte_unmap(page_table);
+	/* The VMA was not fully populated on mmap() or missing VM_DONTEXPAND */
+	if (!vma->vm_ops->fault)
+		return VM_FAULT_SIGBUS;	
 	return __do_fault(mm, vma, address, pmd, pgoff, flags, orig_pte);
 }
 
@@ -3659,11 +3666,9 @@
 	entry = *pte;
 	if (!pte_present(entry)) {
 		if (pte_none(entry)) {
-			if (vma->vm_ops) {
-				if (likely(vma->vm_ops->fault))
-					return do_linear_fault(mm, vma, address,
-						pte, pmd, flags, entry);
-			}
+			if (vma->vm_ops)
+				return do_linear_fault(mm, vma, address,
+						pte, pmd, flags, entry);			
 			return do_anonymous_page(mm, vma, address,
 						 pte, pmd, flags);
 		}
